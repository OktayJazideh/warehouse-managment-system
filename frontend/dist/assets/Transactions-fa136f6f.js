import{r as m,b as _,h as A,o as r,c as d,d as e,w as P,t as l,e as b,f as i,x as D,B as F,v as p,F as N,j as I,k as C,a as O,y as W,z as B,n as L}from"./index-8650e4e1.js";const R={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},z={class:"relative top-20 mx-auto p-5 border max-w-2xl shadow-lg rounded-md bg-white"},Q={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},H=["value"],J=["value"],K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},X={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Y={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Z={class:"flex justify-end space-x-3 pt-4"},ee=["disabled"],te={__name:"TransactionModal",props:{isOpen:Boolean},emits:["close","saved"],setup($,{emit:T}){const x=T,g=m(!1),c=m(""),f=m([]),n=m([]),o=_({type:"",productId:"",warehouseId:"",quantity:1,unitCost:0,reason:"",notes:"",supplierName:"",customerName:"",transactionDate:new Date().toISOString().split("T")[0]}),S=()=>{o.type="",o.productId="",o.warehouseId="",o.quantity=1,o.unitCost=0,o.reason="",o.notes="",o.supplierName="",o.customerName="",o.transactionDate=new Date().toISOString().split("T")[0],c.value=""},U=async()=>{try{const u=await C.get("/products?limit=1000");f.value=u.data.data.products}catch(u){console.error("Failed to load products:",u)}},y=async()=>{try{const u=await C.get("/warehouses");n.value=u.data.data.warehouses}catch(u){console.error("Failed to load warehouses:",u)}},w=()=>{S(),x("close")},V=async()=>{var u,t,s,a,h,k;g.value=!0,c.value="";try{const v={type:o.type,productId:o.productId,warehouseId:o.warehouseId,quantity:parseInt(o.quantity),unitCost:o.unitCost?parseFloat(o.unitCost):void 0,reason:o.reason||void 0,notes:o.notes||void 0,supplierName:o.supplierName||void 0,customerName:o.customerName||void 0,transactionDate:o.transactionDate||void 0};await C.post("/transactions",v),x("saved"),w()}catch(v){console.error("Transaction creation error:",v),c.value=((t=(u=v.response)==null?void 0:u.data)==null?void 0:t.message)||((k=(h=(a=(s=v.response)==null?void 0:s.data)==null?void 0:a.errors)==null?void 0:h[0])==null?void 0:k.msg)||"An error occurred while creating the transaction"}finally{g.value=!1}};return A(()=>{U(),y()}),(u,t)=>$.isOpen?(r(),d("div",R,[e("div",z,[e("div",{class:"flex justify-between items-center mb-4"},[t[11]||(t[11]=e("h3",{class:"text-lg font-medium text-gray-900"},"Add New Transaction",-1)),e("button",{onClick:w,class:"text-gray-400 hover:text-gray-600"},[...t[10]||(t[10]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:P(V,["prevent"]),class:"space-y-4"},[c.value?(r(),d("div",Q,l(c.value),1)):b("",!0),e("div",E,[e("div",null,[t[13]||(t[13]=e("label",{class:"form-label"},"Transaction Type *",-1)),i(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.type=s),class:"form-input",required:""},[...t[12]||(t[12]=[F('<option value="">Select Type</option><option value="inbound">Inbound (Stock In)</option><option value="outbound">Outbound (Stock Out)</option><option value="adjustment">Adjustment</option><option value="transfer">Transfer</option>',5)])],512),[[D,o.type]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"form-label"},"Transaction Date",-1)),i(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.transactionDate=s),type:"date",class:"form-input"},null,512),[[p,o.transactionDate]])])]),e("div",G,[e("div",null,[t[16]||(t[16]=e("label",{class:"form-label"},"Product *",-1)),i(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.productId=s),class:"form-input",required:""},[t[15]||(t[15]=e("option",{value:""},"Select Product",-1)),(r(!0),d(N,null,I(f.value,s=>(r(),d("option",{key:s.id,value:s.id},l(s.code)+" - "+l(s.name),9,H))),128))],512),[[D,o.productId]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"form-label"},"Warehouse *",-1)),i(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.warehouseId=s),class:"form-input",required:""},[t[17]||(t[17]=e("option",{value:""},"Select Warehouse",-1)),(r(!0),d(N,null,I(n.value,s=>(r(),d("option",{key:s.id,value:s.id},l(s.code)+" - "+l(s.name),9,J))),128))],512),[[D,o.warehouseId]])])]),e("div",K,[e("div",null,[t[19]||(t[19]=e("label",{class:"form-label"},"Quantity *",-1)),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.quantity=s),type:"number",class:"form-input",placeholder:"0",min:"1",required:""},null,512),[[p,o.quantity,void 0,{number:!0}]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"form-label"},"Unit Cost",-1)),i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.unitCost=s),type:"number",class:"form-input",placeholder:"0",min:"0",step:"0.01"},null,512),[[p,o.unitCost,void 0,{number:!0}]])])]),o.type==="inbound"?(r(),d("div",X,[e("div",null,[t[21]||(t[21]=e("label",{class:"form-label"},"Supplier Name",-1)),i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.supplierName=s),type:"text",class:"form-input",placeholder:"Supplier name"},null,512),[[p,o.supplierName]])])])):b("",!0),o.type==="outbound"?(r(),d("div",Y,[e("div",null,[t[22]||(t[22]=e("label",{class:"form-label"},"Customer Name",-1)),i(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>o.customerName=s),type:"text",class:"form-input",placeholder:"Customer name"},null,512),[[p,o.customerName]])])])):b("",!0),e("div",null,[t[23]||(t[23]=e("label",{class:"form-label"},"Reason",-1)),i(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>o.reason=s),type:"text",class:"form-input",placeholder:"Reason for transaction"},null,512),[[p,o.reason]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"form-label"},"Notes",-1)),i(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=s=>o.notes=s),class:"form-input",rows:"3",placeholder:"Additional notes"},null,512),[[p,o.notes]])]),e("div",Z,[e("button",{type:"button",onClick:w,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:g.value,class:"btn-primary"},l(g.value?"Creating...":"Create Transaction"),9,ee)])],32)])])):b("",!0)}},se={class:"sm:flex sm:items-center mb-6"},oe={class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},ae={class:"bg-white p-4 rounded-lg shadow mb-6"},ne={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},le=["value"],re={class:"card"},de={class:"card-body overflow-x-auto"},ie={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-white divide-y divide-gray-200"},pe={class:"px-6 py-4 text-sm font-medium text-gray-900"},me={class:"px-6 py-4 text-sm text-gray-900"},ce={class:"px-6 py-4"},ye={class:"px-6 py-4"},ve={class:"text-sm font-medium text-gray-900"},ge={class:"text-sm text-gray-500"},xe={class:"px-6 py-4 text-sm text-gray-900"},fe={class:"px-6 py-4 text-sm text-gray-900"},be={class:"px-6 py-4 text-sm text-gray-900"},we={key:0,class:"text-center py-8 text-gray-500"},ke={__name:"Transactions",setup($){const T=O(),x=m([]),g=m([]),c=m(!1),f=m(!1),n=m({type:"",startDate:"",endDate:"",warehouseId:""}),o=W(()=>{var t;return["admin","warehouse_manager"].includes((t=T.user)==null?void 0:t.role)}),S=t=>({inbound:"bg-green-100 text-green-800",outbound:"bg-red-100 text-red-800",transfer:"bg-blue-100 text-blue-800",adjustment:"bg-yellow-100 text-yellow-800"})[t]||"bg-gray-100 text-gray-800",U=t=>new Date(t).toLocaleDateString(),y=async()=>{c.value=!0;try{const t=new URLSearchParams;n.value.type&&t.append("type",n.value.type),n.value.startDate&&t.append("startDate",n.value.startDate),n.value.endDate&&t.append("endDate",n.value.endDate),n.value.warehouseId&&t.append("warehouseId",n.value.warehouseId);const s=await C.get(`/transactions?${t}`);x.value=s.data.data.transactions}catch(t){console.error("Failed to load transactions:",t)}finally{c.value=!1}},w=async()=>{try{const t=await C.get("/warehouses");g.value=t.data.data.warehouses}catch(t){console.error("Failed to load warehouses:",t)}},V=()=>{f.value=!1},u=()=>{y()};return A(()=>{y(),w()}),(t,s)=>(r(),d("div",null,[e("div",se,[s[5]||(s[5]=e("div",{class:"sm:flex-auto"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Transactions"),e("p",{class:"text-gray-600"},"Track all inventory movements")],-1)),e("div",oe,[o.value?(r(),d("button",{key:0,type:"button",class:"btn-primary",onClick:s[0]||(s[0]=a=>f.value=!0)}," New Transaction ")):b("",!0)])]),e("div",ae,[e("div",ne,[e("div",null,[i(e("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>n.value.type=a),class:"form-input",onChange:y},[...s[6]||(s[6]=[F('<option value="">All Types</option><option value="inbound">Inbound</option><option value="outbound">Outbound</option><option value="transfer">Transfer</option><option value="adjustment">Adjustment</option>',5)])],544),[[D,n.value.type]])]),e("div",null,[i(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>n.value.startDate=a),type:"date",class:"form-input",onChange:y},null,544),[[p,n.value.startDate]])]),e("div",null,[i(e("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>n.value.endDate=a),type:"date",class:"form-input",onChange:y},null,544),[[p,n.value.endDate]])]),e("div",null,[i(e("select",{"onUpdate:modelValue":s[4]||(s[4]=a=>n.value.warehouseId=a),class:"form-input",onChange:y},[s[7]||(s[7]=e("option",{value:""},"All Warehouses",-1)),(r(!0),d(N,null,I(g.value,a=>(r(),d("option",{key:a.id,value:a.id},l(a.name),9,le))),128))],544),[[D,n.value.warehouseId]])])])]),e("div",re,[e("div",de,[e("table",ie,[s[8]||(s[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Reference"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Product"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Warehouse"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Quantity"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"User")])],-1)),e("tbody",ue,[(r(!0),d(N,null,I(x.value,a=>{var h,k,v,q,M,j;return r(),d("tr",{key:a.id},[e("td",pe,l(a.referenceNumber),1),e("td",me,l(U(a.transactionDate)),1),e("td",ce,[e("span",{class:L(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",S(a.type)])},l(a.type),3)]),e("td",ye,[e("div",null,[e("div",ve,l((h=a.Product)==null?void 0:h.name),1),e("div",ge,l((k=a.Product)==null?void 0:k.code),1)])]),e("td",xe,l((v=a.Warehouse)==null?void 0:v.name),1),e("td",fe,l(a.quantity)+" "+l((q=a.Product)==null?void 0:q.unit),1),e("td",be,l((M=a.User)==null?void 0:M.firstName)+" "+l((j=a.User)==null?void 0:j.lastName),1)])}),128))])]),x.value.length===0?(r(),d("div",we," No transactions found ")):b("",!0)])]),B(te,{"is-open":f.value,onClose:V,onSaved:u},null,8,["is-open"])]))}};export{ke as default};
